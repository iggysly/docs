Сервис аутентификации IMSI
==========================

Общее описание сервиса
----------------------

  Компания Devino Telecom предоставляет финансовым учреждениям услуги по управлению финансами с помощью мобильных технологий. Используя сервисы, предоставляемые Devino Telecom, у клиентов Банка существует возможность управлять своими финансами с мобильного телефона.

  В 2009 году в рамках обеспечения безопасности передачи разовых паролей, используемых для входа в интернет-банк, компанией была предложена и реализована технология проверки подлинности SIM-карт посредством проверки уникального кода IMSI. Благодаря внедренной технологии, при передаче разовых паролей удалось полностью исключить мошенничество с подменой SIM-карт злоумышленниками.

Алгоритм аутентификации IMSI на стороне Банка
---------------------------------------------

  Логика хранения и проверки реализована в банковских информационных системах. 

  Devino Telecom предоставляет Банку SOAP Web-сервис, позволяющий запрашивать IMSI SIM-карты абонента. При этом Web-сервис установлен на технологической площадке Devino Telecom, а программное обеспечение, установленное на технических мощностях Банка, осуществляет удаленные вызовы сервиса.

Реализация данного алгоритма взаимодействия дает Банку следующие возможности:

* Запрашивать IMSI SIM-карты абонента по номеру мобильного телефона (адресу) абонента. После получения первого значения IMSI, Банк сохраняет его значение в своей базе и считает эталонным значением IMSI для текущего клиента. Перед отправкой сообщений, требующих проверки IMSI, Банк обращается в свою БД для сравнения значения IMSI, полученного перед отправкой, и эталонного значения и, в зависимости от результата сравнения, реализует бизнес-логику.
* Запрашивать данные о коммутаторе, на котором зарегистрирован абонент по номеру мобильного телефона (адресу) абонента. Данный запрос позволяет определить реальное  местоположение клиента и сравнить его с заявленным местоположением, например, на период отпуска.
* Запрашивать статус сервиса Devino Telecom. Используется для мониторинга доступности сервиса со стороны Банка.

Все виды операций в рамках взаимодействия между Банком и Devino Telecom инициируются Банком.

Алгоритм аутентификации IMSI на стороне Devino Telecom
------------------------------------------------------

  Логика хранения и проверки реализована на стороне платформы Devino Telecom.

  По SMPP-подключению Devino Telecom получает от Банка сообщение для абонента, в этот момент мы отправляем сообщение и асинхронно запрашиваем эталонное значение IMSI у оператора. Полученное значение IMSI добавляется в таблицу базы данных и считается эталонным.

  Впоследствии при поступлении сообщения для этого абонента мы синхронно проверяем значение IMSI и, в случае совпадения с эталонным, отправляем сообщение абоненту. Если значение не совпадает, то абоненту отправляется сообщение, например, "Ваша SIM-карта не прошла проверку, обратитесь в Банк".

  В личном кабинете Банка есть интерфейс, который позволяет просматривать базу абонентов, запускать процесс получения эталонного IMSI, детально просматривать запросы IMSI и их результат. Там же есть возможность выставить признак, проверять/не проверять IMSI для данного абонента.

  В случаях, когда эталонное значение мы не можем получить, например, если нет технической возможности получать IMSI абонентов определенного оператора, а также в случае недоступности абонента и сбоя на оборудовании оператора, то в зависимости от полученных ошибок, решается продолжать ли попытки (асинхронные) получить IMSI или отправлять сообщение без проверки.

  Банк может реинициализировать абонента (запросить новое эталонное значение IMSI) посредством интерфейса личного кабинета или командой, переданной в e-mail на специальный адрес.

Сценарий использования «Проверка IMSI»
--------------------------------------

При проверке есть **3 возможные** ситуации:
* Новый IMSI записывается базу (т.е. пока сравнивать значение IMSI не с чем, самый первый запрос).
* Проверка IMSI успешна (полученное значение IMSI совпадает с тем, что записано в базе).
* Проверка IMSI не успешна (полученное значение IMSI не совпадает с тем, что записано в базе).

*Для п.1 и п.2 отправляется SMS по операции.*

*Для п.3 SMS по операции блокируется, отправляется SMS с текстом Банка, например, «Уважаемый клиент, операция не проведена, обратитесь в банк по телефону... »*


Описание:

* Новый IMSI записывается в базу (т.е. пока сравнивать значение IMSI не с чем, самый первый за- прос)

  >>В БД для номера телефона ничего нет. Просто записывается новое значение и считается, что это значение правильное.

* Проверка IMSI успешна (полученное значение IMSI совпадает с тем, что записано в базе).

  >>Перед отправкой SMS Банк проверяет IMSI и значение в БД совпадает с тем, что было получено. Проверка пройдена – SMS по операции отправляется.

* Проверка IMSI не успешна (полученное значение IMSI не совпадает с тем, что записано в базе). Клиент звонит в Банк, т.к. получил SMS о том, что операция невозможна в связи с непройденной проверкой IMSI.

  >>Перед отправкой SMS Банк проверяет IMSI и значение в БД не совпадает с тем, что было получено. Новое значение полученного IMSI не сохранено в БД и теперь Банк должен решить, верить ли этому значению или нет. Если Банк верит (после верификации клиента), то надо нажать «Перепроверить», после этого будет сформирован еще один запрос на IMSI и полученное значение будет сохранено в БД как эталонное.

      *Если Банк не верит (верификация клиента не прошла) – никаких действий не требуется. Если Банк знает, что он будет верить всегда и проверять не надо – то он нажимает «Отключить проверку, всегда отправлять».

      *Если Банк знает, что он никогда не будет верить и проверять не надо – это IMSI-телефон мошенника, то необходимо нажать «Отключить проверку, всегда отклонять».
